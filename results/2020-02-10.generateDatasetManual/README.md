# Introduction
The goal is to generate an evolutionary dataset of ppiA and ppiB 
in gram negative bacteria.
We want a set of bacteria that contain both a homologue of ppiA and ppiB.
For the ppiA homologues, 
we have to make sure a signal peptide is present.
For the ppiB homologues,
no signal peptide can be present.

<!--
Here comes a general outline of the steps followed
-->

## Retrieve ppiA and ppiB accession codes / Entry page
Search on Uniprotkb site for ppiA and ppiB and make sure the organism is E. coli.

|Protein|accession|
|-------|---------|
|   ppiA|   P0AFL3|
|   ppiB|   P23869|

## Retrieve Uniref50 members
### explanation
> The UniProt Reference Clusters (UniRef) provide clustered sets 
> of sequences from the UniProt Knowledgebase (including isoforms) 
> and selected UniParc records. 
> This hides redundant sequences and obtains complete coverage 
> of the sequence space at three resolutions:
>
> **UniRef100** combines identical sequences and sub-fragments with 11 or more 
> residues from any organism into a single UniRef entry.
>
> **UniRef90** is built by clustering UniRef100 sequences such 
> that each cluster is composed of sequences that have at least 
> 90% sequence identity to, and 80 percent overlap with, 
> the longest sequence (a.k.a. seed sequence).
>
> **UniRef50** is built by clustering UniRef90 seed sequences that have 
> at least 50 percent sequence identity to, and 80 percent overlap with, 
> the longest sequence in the cluster.
>> https://www.uniprot.org/uniref/


### Procedure

1. Start from the entry page of the protein and scroll down to "similar proteins" and select 50 percent identiy. Press full view.
2. Select the columns: Entry name; Gene names; protein names; Organism; Organism ID; Signal peptide; Length
3. Download as "tab-seperated" datasets.
4. Download "fasta"

## Retrieve Uniref50 members filtered on signal peptide
### explanation
This is very similar to previous step but an extra filter is applied.
For ppiA, we want to make sure a signal peptide is present.
for ppiB, we want to make sure NO signal peptide is present.

### Procedure 
#### ppiA

1. Search for the following on UniprotKb:

`cluster:(uniprot:p0afl3* identity:0.5) annotation:(type:signal)`

2. Download with same columns as in previous step

#### ppiB

1. Search for the following on UniprotKb:

`cluster:(uniprot:p23869* identity:0.5) NOT annotation:(type:signal)`

2. Download with same columns as in previous step

## CDHIT to cluster the sequences
### explanation
We want to use the Uniref50 sequences to generate a HMM.
With this HMM a wider search for ppiA/ppiB proteins will be performed.
Because we want to avoid a bias toward sequences that are very similar 
and abundant,
they will be clustered with a threshold of 90 percent identity.
For each cluster, one representative is chosen.

### Procedure
Use CDHIT on:
http://weizhong-lab.ucsd.edu/cdhit-web-server/cgi-bin/index.cgi?cmd=cd-hit

Default parameters were used on the signal peptide filtered datasets.


## MSA with clustalOmega
https://www.ebi.ac.uk/Tools/msa/clustalo/

### Explanation
To expand the dataset, we will run HHBlitz.
HHBlitz uses a MSA as input (preferentially in fasta format).

### procedure
Therefore, clustalomage was run with FASTA format as output.
Fasta file generated by CDHIT was used as input.


## Expand dataset with HHBlitz
https://toolkit.tuebingen.mpg.de/

### explanation
The dataset can be expanded with HHBlitz, which uses HMM to look for homologues
in the uniclust30_2018_08 database.

### procedure
database:	 	uniclust30_2019_08
max no. of iteration: 	8
No of target sequences:	10000


## Extract list of accession numbers from HHBlitz results
### explanation
No Hit                             Prob E-value P-value  Score    SS Cols Query HMM  Template HMM
  1 tr|A0A1Z4VQR0|A0A1Z4VQR0_9GAMM 100.0 1.7E-55 6.4E-61  348.9   0.0  168   23-190    44-214 (215)
  2 tr|A0A2P4M656|A0A2P4M656_QUESU 100.0   1E-54 3.6E-60  337.7   0.0  155   26-190    42-199 (199)
  3 tr|A0A0F9XTR1|A0A0F9XTR1_9ZZZZ 100.0 9.8E-54 3.4E-59  331.9   0.0  156   25-190    37-199 (201)
  4 tr|A0A1V5HEY5|A0A1V5HEY5_9BACT 100.0 1.1E-53 3.8E-59  334.5   0.0  169   24-192    37-205 (206)
  5 tr|A0A0S4N4L6|A0A0S4N4L6_9BACT 100.0 1.3E-53 5.2E-59  338.5   0.0  156   23-189    23-189 (195)
  6 tr|A0A239TLF6|A0A239TLF6_9FIRM 100.0 1.9E-53 6.7E-59  329.8   0.0  154   26-190    39-193 (196)
  7 tr|A0A0G0IZN4|A0A0G0IZN4_9BACT 100.0 8.4E-53 3.1E-58  334.8   0.0  152   28-190    62-220 (221)

This is an exaple of the output given by HHBlitz.
However, we are interested in a list of accession numbers (given after first |)

### procedure

'grep "^..[0-9]" hhblits_ppiA.out | cut -d "|" -f 2 > hhblits_ppiA.list'

'grep "^..[0-9]" hhblits_ppiB.out | cut -d "|" -f 2 > hhblits_ppiB.list'

## filter accession numbers for signal peptide
https://www.uniprot.org/uploadlists/
### Explanation
The ppiA list is filtered for those proteins that contain a signal peptide.
The ppiB list is filtered for those proteins that contain NO signal peptide.
Make sure the same function is performed: EC:5.2.1.8
Make sure it is a gram negative bacteria

### procedure

1. go to https://www.uniprot.org/uploadlists/ and upload list of accession numbers, search
2. Add extra restrictions in search bar
	* ppiA: AND annotation:(type:signal) AND ec:5.2.1.8
	* ppiB: NOT annotation:(type:signal) AND ec:5.2.1.8
3. Download "tab-separated" file and "fasta" file
